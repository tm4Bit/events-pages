<!doctype html>
<html class="no-js" lang="pt">
  <head>
    <!-- <script -->
    <!--   async -->
    <!--   src="https://www.googletagmanager.com/gtag/js?id=G-ZSW3JEYM3T" -->
    <!-- ></script> -->
    <!-- <script> -->
    <!--   window.dataLayer = window.dataLayer || []; -->
    <!--   function gtag() { -->
    <!--     dataLayer.push(arguments); -->
    <!--   } -->
    <!--   gtag("js", new Date()); -->
    <!--   gtag("config", "G-ZSW3JEYM3T"); -->
    <!-- </script> -->

    <meta charset="UTF-8" />
    <title>Brasil Popload Festival - GM lead show</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0"
    />
    <link rel="shortcut icon" href="../../favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="../../css/normalize.css" />
    <link rel="stylesheet" href="../../css/aos.css" />
    <link rel="stylesheet" href="../../css/tw9.css?v=1.25" />
    <script src="../../js/lib/jquery.min.js"></script>
    <script src="../../js/lib/aos.js"></script>
    <script src="../../js/lib/dexie.js"></script>
    <script src="../../js/offline-leads.js"></script>
    <script src="../../js/lib/jquery.mask.min.js"></script>
    <script src="../../js/auto-email.js" type="text/javascript"></script>
    <!-- <script -->
    <!--   src="https://challenges.cloudflare.com/turnstile/v0/api.js" -->
    <!--   async -->
    <!--   defer -->
    <!-- ></script> -->
    <script>
      if (
        !localStorage.getItem("briefing_id") ||
        !localStorage.getItem("briefing_key")
      ) {
        alert("Acesso não autorizado. Redirecionando...");
        //  window.location.href = 'index.html'; // ou a página anterior
      }

      document.addEventListener("DOMContentLoaded", function () {
        const pswd = localStorage.getItem("pswd");
        if (pswd) {
          const campoK = document.querySelector('input[name="k"]');
          if (campoK) {
            campoK.value = pswd;
          }
        }
      });
    </script>
  </head>
  <body>
    <div id="loader" style="display: none">
      <div class="lds-ripple">
        <div></div>
        <div></div>
      </div>
      <div align="center">
        <h4 class="br">Por favor,<br />aguarde o processamento</h4>
      </div>
    </div>

    <div id="obrigado" class="modal-window">
      <div class="total" align="center">
        <a href="form.html" title="Close" class="modal-close">(X) FECHAR</a>
        <br /><img src="../../img/logo-chevrolet.svg" />
        <h2>Obrigado pelo cadastro ;)</h2>
        <p>Aguarde os novos comunicados Chevrolet, especiais para você.</p>
      </div>
    </div>

    <div class="container-fluid">
      <img src="bg_desk.webp" class="u-max-full-width" />
    </div>

    <div class="container" style="padding: 30px 20px">
      <div id="campos">
        <form
          action="https://leadshowgm.ovlk.com.br/api/leads"
          name="form"
          id="form"
          method="post"
          enctype="multipart/form-data"
        >
          <input type="hidden" name="briefing" value="1" />
          <input type="hidden" name="country" value="1" />
          <input type="hidden" name="k" value="" />

          <div id="campos-cadastro" class="row">
            <div class="twelve columns">
              <div class="campo">
                <label>Nome completo <span>*</span></label
                ><br />
                <input
                  class="u-half-width"
                  type="text"
                  name="nome"
                  placeholder="nome"
                  required
                />
                <input
                  class="u-half-width"
                  type="text"
                  name="snome"
                  placeholder="sobrenome"
                  required
                />
              </div>
              <div class="campo">
                <label>Data de Nascimento<span>*</span></label
                ><br />
                <input class="u-half-width" type="date" name="nasc" required />
              </div>
              <div class="campo">
                <label>CPF<span>*</span></label
                ><br />
                <input
                  class="u-half-width cpf"
                  type="text"
                  name="doc"
                  required
                />
              </div>
              <div class="campo">
                <label>Celular<span>*</span></label
                ><br />
                <input
                  class="u-half-width cel"
                  type="tel"
                  name="cel"
                  required
                />
              </div>
              <div class="campo">
                <label>Instagram<span>*</span></label
                ><br />
                <input
                  class="u-half-width"
                  type="text"
                  name="instagram"
                  required
                />
              </div>
              <div class="campo">
                <label>E-mail<span>*</span></label
                ><br />
                <input
                  class="u-half-width email"
                  type="email"
                  name="email"
                  required
                />
              </div>
            </div>
          </div>

          <div class="row" style="margin: 30px auto">
            <p>
              <input
                type="checkbox"
                value="1"
                style="display: inline-block; margin-bottom: 0"
                name="ckreg"
                required
              />
              &nbsp;Li e estou ciente do regulamento da promoção, disponível
              <a href="regulamento.pdf" target="_blank">neste link</a> e no
              stand da Chevrolet no Popload Festival 2025. Ao marcar esta opção,
              declaro que li, compreendi e estou de acordo com todos os termos e
              condições descritos no regulamento da promoção, disponível para
              consulta.
            </p>
            <!-- <div -->
            <!--   class="cf-turnstile" -->
            <!--   data-sitekey="0x4AAAAAAAVV1LJz4NeNlPue" -->
            <!--   data-callback="javascriptCallback" -->
            <!-- ></div> -->
            <div align="center">
              <input
                type="submit"
                name="sub2"
                id="sub2"
                value="Cadastrar"
                data-rotulo="cadastro-button"
                style="background-color: #91093e"
              />
            </div>
          </div>
        </form>
      </div>
    </div>

    <div class="container-fluid pe" style="background-color: #c0cec2">
      <div class="container">
        <div class="row">
          <div class="eight columns">
            <img class="logope" src="../../img/juntos-na-direcao.webp" />
          </div>
          <div class="four columns links">
            <h5><a href="regulamento.pdf" target="_blank">REGULAMENTO</a></h5>
            <h5>
              <a
                href="https://www.chevrolet.com.br/ajuda/politica-de-privacidade"
                target="_blank"
                >POLÍTICA DE PRIVACIDADE</a
              >
            </h5>
          </div>
        </div>
        <div class="row" align="center">
          <hr style="margin: 20px 0 40px 0; border-color: #fff" />
          <p>
            Copyright © Chevrolet &nbsp; &nbsp; | &nbsp; &nbsp; por
            <a href="//ovlk.com.br" target="_blank">Overlock</a>
          </p>
        </div>
      </div>
    </div>
    <script>
      AOS.init({ easing: "ease-out-back", duration: 850 });
    </script>
    <a href="javascript:" id="return-to-top"><i class="arrow"></i></a>
    <script>
      $(window).scroll(function () {
        if ($(this).scrollTop() >= 50) {
          $("#return-to-top").fadeIn(200);
        } else {
          $("#return-to-top").fadeOut(200);
        }
      });
      $("#return-to-top").click(function () {
        $("body,html").animate({ scrollTop: 0 }, 500);
      });
    </script>
    <script
      type="text/javascript"
      src="https://www.termsfeed.com/public/cookie-consent/4.0.0/cookie-consent.js"
      charset="UTF-8"
    ></script>
    <script type="text/javascript" charset="UTF-8">
      document.addEventListener("DOMContentLoaded", function () {
        cookieconsent.run({
          notice_banner_type: "simple",
          consent_type: "implied",
          palette: "dark",
          language: "pt",
          page_load_consent_levels: [
            "strictly-necessary",
            "functionality",
            "tracking",
            "targeting",
          ],
          notice_banner_reject_button_hide: false,
          preferences_center_close_button_hide: false,
          page_refresh_confirmation_buttons: false,
          website_name: "Pesquisa de Satisfação Chevrolet",
        });
      });
    </script>
    <noscript
      >ePrivacy and GPDR Cookie Consent by
      <a href="https://www.TermsFeed.com/" rel="nofollow"
        >TermsFeed Generator</a
      ></noscript
    >

    <script>
      function validacpf() {
        if (valida_cpf(document.getElementById("cpf").value))
          return true; //alert('CPF válido');
        else alert("CPF inválido, digite-o corretamente");
        cpf.value = "";
      }

      function valida_cpf(cpf_raw) {
        var cpf = "";
        if (cpf_raw) {
          cpf = cpf_raw.replace(/[^0-9]/g, "");
        }
        var numeros, digitos, soma, i, resultado, digitos_iguais;
        digitos_iguais = 1;
        if (cpf.length < 11) return false;
        for (i = 0; i < cpf.length - 1; i++)
          if (cpf.charAt(i) != cpf.charAt(i + 1)) {
            digitos_iguais = 0;
            break;
          }
        if (!digitos_iguais) {
          numeros = cpf.substring(0, 9);
          digitos = cpf.substring(9);
          soma = 0;
          for (i = 10; i > 1; i--) soma += numeros.charAt(10 - i) * i;
          resultado = soma % 11 < 2 ? 0 : 11 - (soma % 11);
          if (resultado != digitos.charAt(0)) return false;
          numeros = cpf.substring(0, 10);
          soma = 0;
          for (i = 11; i > 1; i--) soma += numeros.charAt(11 - i) * i;
          resultado = soma % 11 < 2 ? 0 : 11 - (soma % 11);
          if (resultado != digitos.charAt(1)) return false;
          return true;
        } else return false;
      }
    </script>

    <script type="text/javascript">
      (function ($, config) {
        $(document).ready(function () {
          console.log("DOCUMENT READY - INIT");

          // Email autocomplete
          $(".email").autoEmail(
            [
              "gmail.com",
              "hotmail.com",
              "outlook.com",
              "yahoo.com.br",
              "globo.com",
            ],
            false,
          );

          // Input masks
          $(".cep").mask("00.000-000");
          $(".cel").mask("(00) 9 0000-0000");
          $(".cpf").mask("000.000.000-00");
          $(".data").mask("00/00/0000");

          // Form submission handler
          $("#form").submit(async function (e) {
            console.log("FORM SUBMIT TRIGGERED");
            e.preventDefault();

            const formData = $(this).serializeArray();
            const leadData = {};
            formData.forEach((item) => {
              // Handle multiple checkboxes with the same name (e.g., tipo_conteudo)
              if (leadData[item.name]) {
                if (!Array.isArray(leadData[item.name])) {
                  leadData[item.name] = [leadData[item.name]];
                }
                leadData[item.name].push(item.value);
              } else {
                leadData[item.name] = item.value;
              }
            });

            // Convert array values to comma-separated strings if your API expects that
            for (const key in leadData) {
              if (Array.isArray(leadData[key])) {
                leadData[key] = leadData[key].join(",");
              }
            }

            const obrigadoModal = document.getElementById("obrigado");
            const loader = $("#loader");

            if (navigator.onLine) {
              console.log("Online: Making AJAX request to:", config.formAction);
              console.log("Form data:", $(this).serialize());
              loader.show();

              $.ajax({
                type: "POST",
                url: config.formAction,
                data: $(this).serialize(), // jQuery's serialize() is fine for x-www-form-urlencoded
              })
                .done(function (response) {
                  console.log("AJAX SUCCESS", response);
                  loader.hide();
                  if (obrigadoModal) window.location.href = "#obrigado";
                  $("#form")[0].reset(); // Clear the form
                  if (window.turnstile) window.turnstile.reset(); // Reset Cloudflare Turnstile if used
                })
                .fail(function (xhr, textStatus, errorThrown) {
                  console.log("AJAX FAIL", xhr, textStatus, errorThrown);
                  loader.hide();
                  if (window.turnstile) window.turnstile.reset(); // Reset Cloudflare Turnstile
                  try {
                    var response = JSON.parse(xhr.responseText);
                    if (response.errors) {
                      alert(response.errors.join("\n"));
                    } else {
                      alert(
                        "Não foi possível realizar o cadastro. Tente mais tarde",
                      );
                    }
                  } catch (parseError) {
                    alert(
                      "Erro de conexão ou ao processar a resposta. Tente novamente.",
                    );
                  }
                });
            } else {
              console.log("Offline: Saving lead to IndexedDB.");
              loader.show();
              try {
                await saveLeadOffline(leadData);
                loader.hide();
                alert(
                  "Você está offline. Seu cadastro foi salvo e será enviado quando houver conexão.",
                );
                // Don't show #obrigado immediately for offline, it will show after successful sync.
                // Or, you can show a different message/modal for offline saves.
                // For now, just alert and reset form.
                $("#form")[0].reset(); // Clear the form
                if (window.turnstile) window.turnstile.reset(); // Reset Cloudflare Turnstile
              } catch (offlineError) {
                loader.hide();
                console.error("Failed to save lead offline:", offlineError);
                alert(
                  "Não foi possível salvar o cadastro offline. Tente novamente.",
                );
              }
            }
          });

          // Analytics tracking for data-rotulo elements
          // $("[data-rotulo]").click(function () {
          //   console.log("Analytics click tracked:", $(this).data("rotulo"));
          //   if (window.location.href.indexOf("localhost") > -1) {
          //     console.log("[user_id]", "");
          //     console.log(
          //       "[form_id]",
          //       $(this).closest("form").attr("id") || "",
          //     );
          //     console.log("[click_id]", $(this).attr("id") || "");
          //     console.log("[event]", "click-" + $(this).data("rotulo"));
          //   }
          //   window.dataLayer.push({
          //     user_id: "",
          //     form_id: $(this).closest("form").attr("id") || "",
          //     click_id: $(this).attr("id") || "",
          //     event: "click-" + $(this).data("rotulo"),
          //   });
          // });

          // Input validation styling
          const inputs = document.querySelectorAll("input, select, textarea");
          for (let input of inputs) {
            input.addEventListener(
              "invalid",
              (event) => {
                input.classList.add("error");
              },
              false,
            );

            input.addEventListener("blur", (event) => {
              input.checkValidity();
            });
          }
        });
      })(jQuery, {
        baseUrl:
          window.location.href.indexOf("http://localhost") == 0
            ? "http://localhost"
            : "https://gm.ovlk.com.br",
        formAction:
          window.location.href.indexOf("http://localhost") == 0
            ? "http://localhost:8080/api/leads"
            : jQuery("#form").attr("action"),
      });
    </script>

    <script>
      function validarCEP() {
        var cepInput = document.getElementById("cep");
        var cep = cepInput.value;
        cep = cep.replace(/[.-]/g, "");
        var cepRegex = /^[0-9]{8}$/;

        if (cepRegex.test(cep)) {
          fetch("https://viacep.com.br/ws/${cep}/json/")
            .then((response) => response.json())
            .then((data) => {
              if (data.erro) {
                cepInput.value = "";
                alert("CEP inválido. Por favor, insira um CEP válido.");
                $("#campos-cadastro").show();
              } else {
                $('form [name="uf"]').val(data.uf);
                $('form [name="cidade"]').val(data.localidade);
              }
            })
            .catch((error) =>
              console.error("Erro na solicitação à API:", error),
            );
        } else {
          cepInput.value = "";
          alert("CEP inválido. Por favor, insira um CEP válido.");
        }
      }
    </script>
  </body>
</html>
